<?xml version="1.0"?>
<odoo>
  <record id="registration_template_attendeeloggedin" model="ir.ui.view">
    <field name="name">registration.template.attendeeloggedin</field>
    <field name="inherit_id" ref="website_event.registration_template"/>
    <field name="priority">99</field>
    <field name="arch" type="xml">
    <xpath expr="//form[@id='registration_form']" position="replace">
        <form id="registration_form" t-attf-action="/event/#{slug(event)}/registration/new" method="post" class="card" t-if="buy">
            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
            <div class="card-header d-none d-lg-block">
                <div class="row">
                    <div class="col-lg-3">
                        <h5><b>Ticket Type</b></h5>
                    </div>
                    <div class="col-lg-3">
                        <h5><b>End of Registration</b></h5>
                    </div>
                    <div class="col-lg-3">
                        <h5><b>Price</b></h5>
                    </div>
                    <div class="col-lg-3">
                        <h5><b>Quantity</b></h5>
                    </div>
                </div>
            </div>
            <t t-id="tickets" t-call="website_event.ticket">
                <t t-set="name">
                    <span itemprop="name">Event Registration</span>
                </t>
                <t t-set="registration_end">
                    <t t-if="event.date_begin">
                        <span t-esc="event.date_begin_located"/>
                    </t>
                    <t t-if="not event.date_begin">
                        <span>Unlimited</span>
                    </t>
                </t>
                <t t-set="price">
                    <span itemprop="price" content="0">
                        Free
                    </span>
                </t>
                <t t-set="quantity">
                    <div t-if="event.website_attendee_require_login">
                      <t t-if="event.seats_availability == 'unlimited' or event.seats_available > 0">
                        <t t-if="event.seats_availability != 'unlimited'">
                          Seats available: <strong t-esc="event.seats_available"></strong>
                        </t>
                        <select name="nb_register-0" class="form-control" style="display:none;">
                          <option selected="1" value="1">1</option>
                        </select>
                      </t>
                    </div>
                    <select t-else="" name="nb_register-0" class="form-control">
                      <t t-foreach="range(0, (event.seats_availability == 'unlimited' or event.seats_available &gt; 9) and 10 or event.seats_available+1)" t-as="nb">
                        <option t-esc="nb" t-att-selected="nb == 1 and 'selected'"/>
                      </t>
                    </select>
                </t>
            </t>
            <div class="card-footer">
                <div class="row">
                  <span t-if="(event.website_attendee_require_login and event.is_participating)==true" class="alert alert-warning">You already registered for a ticket on this account - Contact us if you wish to cancel</span>
                  <div t-else="" class="col-lg-4 offset-lg-8 col-xl-3 offset-xl-9">
                    <button type="submit" class="btn btn-primary btn-lg btn-block a-submit" t-attf-id="#{event.id}"> Register&amp;nbsp;</button>
                  </div>
                </div>
            </div>
        </form>
    </xpath>
    </field>
  </record>
</odoo>
