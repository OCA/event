<?xml version="1.0" encoding="utf-8"?>
<!-- License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
     © 2015 Grupo ESOC Ingeniería de Servicios, S.L.U. -->

<openerp>
<data>

<!-- Paper format for diplomas; landscape A4 with HiDIP -->
<record id="diploma_paperformat" model="report.paperformat">
    <field name="name">European Landscape A4 for Diplomas</field>
    <field name="default" eval="True"/>
    <field name="format">A4</field>
    <field name="page_height">0</field>
    <field name="page_width">0</field>
    <field name="orientation">Landscape</field>
    <field name="margin_top">40</field>
    <field name="margin_bottom">23</field>
    <field name="margin_left">7</field>
    <field name="margin_right">7</field>
    <field name="header_line" eval="False"/>
    <field name="header_spacing">35</field>
    <field name="dpi">300</field>
</record>

<!-- Templates -->
<template id="diploma_report">
    <t t-call="report.html_container">
        <t t-foreach="doc_ids" t-as="doc_id">
            <t t-raw="translate_doc(doc_id, doc_model, 'partner_id.lang',
                                    'training.diploma_report_translatable')"/>
        </t>
    </t>
</template>

<template id="diploma_report_translatable">
    <t t-call="report.external_layout">
        <div class="page">
            <div class="row">
                <h1 class="col-md-12 text-center">Diploma</h1>
                <p class="col-md-12 text-center" t-esc="res_company.name"/>
                <h4 class="col-md-12 text-center">Certifies that</h4>
                <h2 class="col-md-12 text-center" t-esc="o.name"/>
                <p class="col-md-12">
                    Has successfully completed the course
                    <t t-esc="o.event_id.training_action_id.name"/>, in
                    <t t-esc="o.with_context(show_address=True).event_id
                              .address_id.name_get()[0][1]"/>,
                    imparted from <t t-esc="o.event_id.date_begin"/>
                    to <t t-esc="o.event_id.date_end"/>.
                </p>
                <p class="col-md-12">
                    <t t-if="o.event_id.address_id and
                             o.event_id.address_id.city">
                        <t t-esc="o.event_id.address_id.city"/>, at
                    </t>
                    <t t-esc="o.event_id.date_end"/>.
                </p>
            </div>
        </div>
    </t>
</template>

<!-- Report action -->
<report
    id="diploma_action"
    model="event.registration"
    name="Diploma"
    string="Diploma"
    report_type="qweb-pdf"
    groups="user_group"
    attachment="object.state == 'done' and 'diploma.pdf'"
    multi="False"/>

<record id="diploma_action" model="ir.actions.report.xml">
    <field name="report_name">training.diploma_report</field>
    <field name="paperformat_id" ref="diploma_paperformat"/>
</record>

</data>
</openerp>
